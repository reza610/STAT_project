---
title: "Final_Project"
author: "Nathan Shiosaki and Reza Naiman"
date: "3/30/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


to get the dates to work for the CPI data, I had to install the zoo library for the as.yearmon function
```{r pressure, echo=FALSE, warning=FALSE}
library(tidyverse)
library(zoo)
library(dslabs)
library(caret)
library(stringr)
library(ggplot2)
library(dplyr)
library(tibble)
CPI_data <- read.csv("CPI_data.csv")
Covid_data <- read.csv("trends_in_covid19_cases_and_deaths_in_the_us_reported_to_cdc_by_population_factors.csv")

```


```{r}
Clean_Covid_Data <- Covid_data %>% filter(Classification == "Metro_Rural") %>% filter(Category == 1)
Clean_Covid_Data <- Clean_Covid_Data %>% mutate(Date = as.Date(Clean_Covid_Data$Date, format = "%m/%d/%Y")) 

CPI_data <- CPI_data %>%  mutate(Date = as.Date(as.yearmon(CPI_data$Date, format = '%Y-%B')))

All_Data <- inner_join(CPI_data, Clean_Covid_Data)

```


```{r}
CPI_data %>% ggplot(aes(Date, Bread)) + geom_line()

Clean_Covid_Data  %>% ggplot(aes(Date, X7.Day.Avg.New.Cases.per.100K)) + geom_line()

All_Data %>% ggplot(aes(X7.Day.Avg.New.Cases.per.100K, Educational.books.and.supplies)) + geom_point()
```


```{r}
eggs <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Eggs, data = All_Data))
bread <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Bread, data = All_Data))
chicken <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Chicken, data = All_Data))
food <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Chicken + Bread + Eggs, data = All_Data))

```


```{r}
gas <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Unleaded.regular.gasoline, data = All_Data))
electricity <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Electricity, data = All_Data))
natural_gas <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Utility..gas.service, data = All_Data))
power <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Utility..gas.service + Electricity + Unleaded.regular.gasoline, data = All_Data))

```


```{r}
day_care <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Day.care.and.preschool, data = All_Data))
college_tuition <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ College.tuition.and.fees, data = All_Data))
educational_supplies <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Educational.books.and.supplies, data = All_Data))
education <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Educational.books.and.supplies + College.tuition.and.fees + Day.care.and.preschool, data = All_Data))
```


```{r}
parking_fees <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Parking.fees.and.tolls, data = All_Data))
motor_insurance <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Motor.vehicle.insurance, data = All_Data))
airline_fares <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Airline.fares, data = All_Data))
transportation <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Airline.fares + Motor.vehicle.insurance + Parking.fees.and.tolls, data = All_Data))

```


```{r}
prescription_drugs <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Prescription.drugs, data = All_Data))
nonprescription_drugs <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Nonprescription.drugs, data = All_Data))
medical_supplies <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Medical.equipment.and.supplies, data = All_Data))
medicine <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Medical.equipment.and.supplies + Nonprescription.drugs + Prescription.drugs, data = All_Data))

```


```{r}
music <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Recorded.music.and.music.subscriptions, data = All_Data))
cable_tv <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Cable.and.satellite.television.service, data = All_Data))
video_rentals <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Rental.of.video.discs.and.other.media, data = All_Data))
books <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Recreational.books, data = All_Data))
entertainment <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Recreational.books + Rental.of.video.discs.and.other.media + Cable.and.satellite.television.service + Recorded.music.and.music.subscriptions, data = All_Data))

```


```{r}
outdoor_equipment <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Outdoor.equipment.and.supplies, data = All_Data))
indoor_plants <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Indoor.plants.and.flowers, data = All_Data))
cleaning_supplies <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Household.cleaning.products, data = All_Data))
rent <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Rent.of.primary.residence, data = All_Data))
home <- summary(lm(X7.Day.Avg.New.Cases.per.100K ~ Rent.of.primary.residence + Household.cleaning.products + Indoor.plants.and.flowers + Outdoor.equipment.and.supplies, data = All_Data))

```

